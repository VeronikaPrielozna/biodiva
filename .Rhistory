F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 + legh, ncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S")
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", ncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S")
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 20,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", ncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S")
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 15,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", ncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S")
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 12,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", ncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S")
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", ncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S")
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, lncol = ncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", lncol = 1)
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", lncol = 1)
RI <- richness(data, ylab = "Number of S", lncol = 1, legl = 12)
RI <- richness(data, ylab = "Number of S", lncol = 1, legl = 11)
RI <- richness(data, ylab = "Number of S", legl = 11)
RI <- richness(data, ylab = "Number of S", legl = 12.5)
RI <- richness(data, ylab = "Number of S", legl = 12.7)
RI <- richness(data, ylab = "Number of S", legl = 12.8)
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = ("red", "blue", "green"))
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"), las = 1)
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"), las = 3)
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"), las = 3)
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
axis(2, yaxp=c(10, 200, 19), las=2)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
axis(2, yaxp=c(10, 200, 1), las=2)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
axis(2, yaxp=c(maxS2 * 1.2), las=2)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),
"Other"), col=col,args.legend = list(bty = "n", x = legl,
y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),"Other"), col=col,
args.legend = list(bty = "n", x = legl, y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
richness<-function(x, first.col = 2, graph = T, legh = 10, legl = 10,
col = c("gray0", "gray48", "gray84"),
ylab = "Number of species", lncol = 3, ...){
x<-x[,first.col:ncol(x)]
F1<-apply(x, 2, function(f1) sum(f1==1))
F2<-apply(x, 2, function(f2) sum(f2==2))
Other<-apply(x, 2, function(f4) sum(f4>2))
Total<-F1 + F2 + Other
SRtab<-rbind(F1,F2,Other,Total)
maxS<-max(SRtab[1,] + SRtab[2,])
maxS2<-max(SRtab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,2,0.5), las = 2)
posgr = barplot(SRtab, plot = F)
barplot(SRtab[-4,], ylim = c(0,maxS2 * 1.2), xaxs="r",
legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])),"Other"), col=col,
args.legend = list(bty = "n", x = legl, y = maxS2 * 1.2 + legh, ncol = lncol))
title(ylab=ylab, line=2.5)
text(posgr, Total, lab=Total, cex=0.9, pos=3)
}
return(SRtab)
}
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"))
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"), first.col = 1)
RI <- richness(data, ylab = "Number of S", legl = 12.8, col = c("red", "blue", "green"), first.col = 3)
gc()
gc()
loadData<-function(file="clipboard",first.col=2, na2null=T, attrib=T) {
cat(paste("Copy data into cliboard."))
invisible(readline(prompt="Press [enter] to continue. "))
tryCatch(silent=T,
expr = {
x<-read.table(file, h=T, sep = "\t")
message("Dataset successfully uploaded.")
},
error = function(e){
message("Dataset inaccurately uploaded, Try again.")
print(e)
},
warning = function(w){
message("Warning! Dataset inaccurately uploaded. Try again.")
print(w)
},
finally = {
attr(x,"Spec_col")<-first.col:ncol(x)
attr(x, "Number of species")<-nrow(x)
attr(x,"Number of samples")<-ncol(x)-1
y<-unlist(lapply(as.list(first.col:ncol(x)),function(x1) is.numeric((x[,x1]))))
if(all(y, na.rm = TRUE)==F){
colbad<-which(y==FALSE) + first.col-1
cat(paste("Samples",paste(names(x)[colbad],collapse=","),"are not numeric"))
cat("\n")
answ=readline(prompt="Continue and skip non-numeric columns? y/n  ")
if(answ=="y") x<-x[-colbad] else stop(paste("Function was terminated. Try to fix the dataset."))
}
if(na2null==T) x[is.na(x)]<-0
if (attrib==T){
print("Attributes of table")
print(attributes(x))
}
cat(paste("Short data:"), "\n")
print(x[1:5,])
cat("\n")
message("You can continue.")
}
)
return(x)
}
loadData()
data<-loadData()
abundance<-function(x, first.col = 2, graph = T, legh = 50, legl = 10, ylab = "Abundance",
col = c("gray0", "gray48", "gray84"), ...){
x<-x[,first.col:ncol(x)]
TotalA<-apply(x, 2, function(f5) sum(f5))
F1<-apply(x, 2, function(f1) sum(f1==1))
F2A<-apply(x, 2, function(f2) sum(f2==2))*2
OtherA<-TotalA-F1-F2A
Atab<-rbind(F1,F2A,OtherA,TotalA)
rownames(Atab)<-c("F1", "F2", "Other", "Total")
maxA<-max(Atab[1,] + Atab[2,])
maxA2<-max(Atab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(3.85,4,4,0.5), las = 2)
posgr = barplot(Atab, plot = F)
barplot(Atab[-4,],legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])), "Other"),
ylab = ylab, ylim = c(0, maxA2 + 30), col = col,
args.legend = list(bty = "n", x = legl, y = maxA2 + legh, ncol = 3), ...)
text(posgr, TotalA, lab = TotalA, cex = 0.9, pos = 3)
}
return(Atab)
}
AB<-abundance(data)
AB<-abundance(data, legh = 100, legl = 20, ylab = "AB", col = ("red", "green", "blue"))
AB<-abundance(data, legh = 100, legl = 20, ylab = "AB", col = ("red", "green", "blue"))
AB<-abundance(data, legh = 100, legl = 20, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 15, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 10, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
abundance<-function(x, first.col = 2, graph = T, legh = 50, legl = 10, ylab = "Abundance",
col = c("gray0", "gray48", "gray84"), ...){
x<-x[,first.col:ncol(x)]
TotalA<-apply(x, 2, function(f5) sum(f5))
F1<-apply(x, 2, function(f1) sum(f1==1))
F2A<-apply(x, 2, function(f2) sum(f2==2))*2
OtherA<-TotalA-F1-F2A
Atab<-rbind(F1,F2A,OtherA,TotalA)
rownames(Atab)<-c("F1", "F2", "Other", "Total")
maxA<-max(Atab[1,] + Atab[2,])
maxA2<-max(Atab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,4,0.5), las = 2)
posgr = barplot(Atab, plot = F)
barplot(Atab[-4,],legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])), "Other"),
ylab = ylab, ylim = c(0, maxA2 + 30), col = col,
args.legend = list(bty = "n", x = legl, y = maxA2 + legh, ncol = 3), ...)
text(posgr, TotalA, lab = TotalA, cex = 0.9, pos = 3)
}
return(Atab)
}
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
abundance<-function(x, first.col = 2, graph = T, legh = 50, legl = 10, ylab = "Abundance",
col = c("gray0", "gray48", "gray84"), ...){
x<-x[,first.col:ncol(x)]
TotalA<-apply(x, 2, function(f5) sum(f5))
F1<-apply(x, 2, function(f1) sum(f1==1))
F2A<-apply(x, 2, function(f2) sum(f2==2))*2
OtherA<-TotalA-F1-F2A
Atab<-rbind(F1,F2A,OtherA,TotalA)
rownames(Atab)<-c("F1", "F2", "Other", "Total")
maxA<-max(Atab[1,] + Atab[2,])
maxA2<-max(Atab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,4,0.5), las = 2)
posgr = barplot(Atab, plot = F)
barplot(Atab[-4,],legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])), "Other"),
ylab = ylab, ylim = c(0, maxA2 + 30), col = col,
args.legend = list(bty = "n", x = legl, y = maxA2  * 1.2 + legh, ncol = 3), ...)
text(posgr, TotalA, lab = TotalA, cex = 0.9, pos = 3)
}
return(Atab)
}
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
abundance<-function(x, first.col = 2, graph = T, legh = 50, legl = 10, ylab = "Abundance",
col = c("gray0", "gray48", "gray84"), ...){
x<-x[,first.col:ncol(x)]
TotalA<-apply(x, 2, function(f5) sum(f5))
F1<-apply(x, 2, function(f1) sum(f1==1))
F2A<-apply(x, 2, function(f2) sum(f2==2))*2
OtherA<-TotalA-F1-F2A
Atab<-rbind(F1,F2A,OtherA,TotalA)
rownames(Atab)<-c("F1", "F2", "Other", "Total")
maxA<-max(Atab[1,] + Atab[2,])
maxA2<-max(Atab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,4,0.5), las = 2)
posgr = barplot(Atab, plot = F)
barplot(Atab[-4,],legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])), "Other"),
ylab = ylab, ylim = c(0, maxA2 + 30), col = col,
args.legend = list(bty = "n", x = legl, y = maxA2 * 1.2 + legh, ncol = 3), ...)
text(posgr, TotalA, lab = TotalA, cex = 0.9, pos = 3)
}
return(Atab)
}
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
abundance<-function(x, first.col = 2, graph = T, legh = 50, legl = 10, ylab = "Abundance",
col = c("gray0", "gray48", "gray84"), ...){
x<-x[,first.col:ncol(x)]
TotalA<-apply(x, 2, function(f5) sum(f5))
F1<-apply(x, 2, function(f1) sum(f1==1))
F2A<-apply(x, 2, function(f2) sum(f2==2))*2
OtherA<-TotalA-F1-F2A
Atab<-rbind(F1,F2A,OtherA,TotalA)
rownames(Atab)<-c("F1", "F2", "Other", "Total")
maxA<-max(Atab[1,] + Atab[2,])
maxA2<-max(Atab[4,])
if (graph == T){
par(mfrow=c(1,1), mar=c(4,4,4,0.5), las = 2)
posgr = barplot(Atab, plot = F)
barplot(Atab[-4,],legend.text = c(as.expression(bquote('F'['1'])), as.expression(bquote('F'['2'])), "Other"),
ylab = ylab, ylim = c(0, maxA2 + 30), col = col,
args.legend = list(bty = "n", x = legl, y = maxA2 * 1.2 + legh, ncol = 3), ...)
text(posgr, TotalA, lab = TotalA, cex = 0.9, pos = 3)
}
return(Atab)
}
AB<-abundance(data, legh = 200, legl = 11, ylab = "AB", col = c("red", "green", "blue"))
load("C:/Users/verca/Desktop/ŠKOLA/Bakalář/BAKALÁŘKA/Software/funkce/Eco_data.RData")
